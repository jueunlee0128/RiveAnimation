<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MoaSub Animation Assets</title>
    <script src="https://unpkg.com/@rive-app/canvas@2.7.0"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <h1>ðŸŽ¬ MoaSub Rive Gallery</h1>
    
    <div class="gallery-grid" id="gallery">
        </div>

    <script>
        const REPO_URL = window.location.origin + window.location.pathname.replace('index.html', '');
        const RIVE_FOLDER = 'rive/';

        const files = [
            // { file: 'íŒŒì¼ëª….riv', artboard: 'ì•„íŠ¸ë³´ë“œëª…', name: 'í‘œì‹œ ì´ë¦„' }
            { file: 'TabIconSet.riv', artboard: 'eye-CLICK', name: 'ëˆˆ' },
            { file: 'TabIconSet.riv', artboard: 'Gear-CLICK', name: 'ê¸°ì–´' },
            { file: 'TabIconSet.riv', artboard: 'Home-CLICK', name: 'í™ˆ' },
            { file: 'TabIconSet.riv', artboard: 'Download-CLICK', name: 'ë‹¤ìš´ë¡œë“œ' },
        ];

        const gallery = document.getElementById('gallery');

        files.forEach((item, index) => {
            const fullUrl = `${REPO_URL}${RIVE_FOLDER}${item.file}`;
            const card = document.createElement('div');
            card.className = 'card';
            const canvasId = `canvas-${index}`;

            card.innerHTML = `
                <canvas id="${canvasId}"></canvas>
                <div class="file-name">${item.name}</div>
                ${item.artboard ? `<span class="badge">Artboard: ${item.artboard}</span>` : ''}
                <div class="link-container">
                    <input type="text" class="link-input" value="${fullUrl}" readonly>
                    <button class="copy-btn" onclick="copyLink(this, '${fullUrl}')">Copy</button>
                </div>
            `;
            gallery.appendChild(card);

            // â˜… Rive ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
            const r = new rive.Rive({
                src: fullUrl,
                canvas: document.getElementById(canvasId),
                autoplay: true,
                artboard: item.artboard,
                stateMachines: "State Machine 1", // â˜… í•„ìˆ˜: ìƒíƒœ ë¨¸ì‹  ì´ë¦„ (ëŒ€ë¶€ë¶„ "State Machine 1")
                onLoad: () => {
                    r.resizeDrawingSurfaceToCanvas();
                }
            });

            // â˜… ìº”ë²„ìŠ¤ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            document.getElementById(canvasId).addEventListener('click', () => {
                // 1. í•´ë‹¹ ì•„íŠ¸ë³´ë“œì˜ ìž…ë ¥ê°’(Inputs)ë“¤ì„ ëª¨ë‘ ê°€ì ¸ì˜´
                const inputs = r.stateMachineInputs("State Machine 1");
                
                if (!inputs) return;

                // 2. í”ížˆ ì“°ì´ëŠ” ì´ë¦„('active', 'click', 'trigger', 'hover')ì„ ì°¾ìŒ
                const targetInput = inputs.find(i => 
                    i.name.toLowerCase() === 'active' || 
                    i.name.toLowerCase() === 'click' || 
                    i.name.toLowerCase() === 'trigger' ||
                    i.name.toLowerCase() === 'hover'
                );

                // 3. ì°¾ì•˜ë‹¤ë©´ íƒ€ìž…ì— ë§žì¶° ì‹¤í–‰
                if (targetInput) {
                    // Boolean íƒ€ìž…(True/False)ì¸ ê²½ìš° -> í† ê¸€
                    if (targetInput.type === rive.StateMachineInputType.Boolean) {
                        targetInput.value = !targetInput.value;
                    } 
                    // Trigger íƒ€ìž…(ë°©ì•„ì‡ )ì¸ ê²½ìš° -> ë°œì‚¬
                    else if (targetInput.type === rive.StateMachineInputType.Trigger) {
                        targetInput.fire();
                    }
                } else {
                    console.log("í´ë¦­ ê°€ëŠ¥í•œ Inputì„ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. Input ì´ë¦„ì„ í™•ì¸í•˜ì„¸ìš”:", inputs.map(i => i.name));
                }
            });
        });

        function copyLink(btn, text) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = btn.innerText;
                btn.innerText = 'OK!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove('copied');
                }, 2000);
            });
        }
    </script>
</body>
</html>